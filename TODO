01. MPD configuration

	$ sudo nano /etc/mpd.conf.sav

		#state_file "/var/lib/mpd/state"
		 mixer_type "none"
		 audio_output {
		 device "pcm.hw"
		 mixer_device "ctl.hw"
		 buffer_before_play "10.5596937298023%"
		 }
		 mixer_type "none"

02. MPD CPU affinities

	$ sudo nano /etc/rc.local

		taskset -pc $s_task $pgr_mpd
		  mpd)		 taskset -cp $h_task $proc_nr ;;
		  io)		 taskset -cp $s_task $proc_nr ;;
		  rtio)		 taskset -cp $s_task $proc_nr
				 chrt -opv 0         $proc_nr ;;
		  player)	 taskset -cp $s_task $proc_nr ;;
		  decoder)	 taskset -cp $s_task $proc_nr ;;
		  output)	 taskset -cp $m_task $proc_nr
				 chrt -opv 0         $proc_nr ;;

03. ALSA configuration

	$ sudo nano /usr/share/alsa/alsa.conf.min

		pcm.hw {type hw card 0 device 0 subdevice 0}

		### Kodi
		
		ctl {default ctl.hw}
		pcm {default pcm.hw}
		pcm.hw {type hw card 0 device 0 subdevice 0}

	$ sudo nano /usr/share/alsa/alsa.conf.{mix,plug}

04. Sysctl

	$ sudo nano /etc/sysctl.conf

		 kernel.sched_wakeup_granularity_ns = 388287
		 kernel.sched_latency_ns = 1394065
		 kernel.sched_migration_cost_ns = 4899005
		 net.ipv4.tcp_rmem = 4604 88254 3345671
		 net.ipv4.tcp_wmem = 4528 89899 3455599
		#net.ipv4.udp_mem = 46552 57912 87618

04. RoonBridge to ram

	$ sudo nano /etc/systemd/system/roonbridge.service
	  ...
	$ sudo cp /etc/systemd/system/roonbridge.service /etc/systemd/system/roonbridgetoram.service
	$ sudo sed -i 's/\/opt\//\/dev\/shm\//' /etc/systemd/system/roonbridgetoram.service
	$ sudo systemctl daemon-reload
	$ sudo systemctl disable roonbridge roonbridgetoram
	$ ls -al /etc/init.d/roonbridge
	$ sudo nano /etc/rc.local
		roon_bridge () {
		 if [ "$roontoram" = on ]; then
		  cp -r /opt/RoonBridge /dev/shm/
		  systemctl start roonbridgetoram
		 else
		  systemctl start roonbridge
		 fi
		}
	# nano /etc/default/audio.conf		# for Artik
		roontoram=on

05. Roonbridge binaries

	$ ls -al /opt/RoonBridge/Bridge/processreaper
	$ sudo strip --strip-debug /opt/RoonBridge/Bridge/processreaper
	$ ls -al /opt/RoonBridge/Bridge/processreaper

	$ find /opt/RoonBridge/ -name *.so -exec ls -al {} \;
	$ find /opt/RoonBridge/ -name *.so -exec sudo chmod -x {} \; -exec sudo strip --strip-debug {} \;
	$ find /opt/RoonBridge/ -name *.so -exec ls -al {} \;

06. Roonbridge without --debug argument

07. ALSA initialization and Tasksets for Artik

	# nano /etc/rc.local
	
		### ALSA initialization

		[ -r /etc/default/audio.conf ] && . /etc/default/audio.conf

		cp /etc/libasound.so.2.0.0.mix /dev/shm/libasound.so.2
		printf 'ctl.default{type hw card 0}' > /dev/shm/alsa.conf
		ln -sf /dev/shm/alsa.conf /usr/share/alsa/alsa.conf
		amixer sset "..." off
		cp /usr/share/alsa/alsa.conf.mix /dev/shm/alsa.conf
		#rm /dev/snd/hw* /dev/snd/seq /dev/snd/timer || true

		if [ "$alsa" = plug ]; then
		 cp /etc/libasound.so.2.0.0.plug /dev/shm/libasound.so.2
		 cp /usr/share/alsa/alsa.conf.plug /dev/shm/alsa.conf
		elif [ "$alsa" = min ] && [ "$roon" = off ] && [ "$spotify" = off ]; then
		 cp /etc/libasound.so.2.0.0.min /dev/shm/libasound.so.2
		 cp /usr/share/alsa/alsa.conf.min /dev/shm/alsa.conf
		 rm -rf /dev/snd/*c /dev/snd/by* || true
		 rm /dev/snd/hw* /dev/snd/seq /dev/snd/timer || true
		#else
		#cp /etc/libasound.so.2.0.0.mix /dev/shm/libasound.so.2
		#cp /usr/share/alsa/alsa.conf.mix /dev/shm/alsa.conf
		#rm /dev/snd/hw* /dev/snd/seq /dev/snd/timer || true
		fi

		#ln -sf /dev/shm/alsa.conf /usr/share/alsa/alsa.conf

		### Taskset

		for i in $(awk '/hci/{print +$1}' /proc/interrupts); do
		 echo "80" > /proc/irq/$i/smp_affinity || true
		done
		for i in $(awk '/enp3s0|1f.2/{print +$1}' /proc/interrupts); do
		 echo "20" > /proc/irq/$i/smp_affinity || true
		done
		for i in $(awk '/mei|nvkm|i915|iwlwifi|xhci/{print +$1}' /proc/interrupts); do
		 echo "40" > /proc/irq/$i/smp_affinity || true
		done
		echo "20" > /proc/irq/default_smp_affinity || true
		for pid in 1 $(pgrep -x rc.local); do
		 taskset -cp $s_task $pid || true
		done

08. Disable services

	$ pstree
	$ systemctl list-unit-files -t service | awk '$2~/enabled/'
	$ sudo systemctl disable dmesg resolvconf
	# systemctl disable armbian-hardware-monitor armbian-hardware-optimize armbian-ramlog dbus-org.freedesktop.timesync1 fake-hwclock.service resolvconf sysstat # armbian

09. Disable qdisc ingress

	$ sudo nano /etc/rc.local
		#tc qdisc add dev $dev ingress

10. Disable nohup

cf) Artik710

	-. Disable connman
	-. Blacklist modules
		kernel/sound/soc/nexell/nexell-snd-pcm.ko
		kernel/sound/soc/nexell/nexell-snd-i2s.ko
		kernel/sound/soc/nexell/nexell-snd-spdiftx.ko
		kernel/sound/soc/nexell/nexell-snd-alc5658.ko
		kernel/sound/soc/nexell/nexell-snd-null.ko
		kernel/sound/soc/nexell/nexell-snd-spdif-transceiver.ko
	-. CPU affinities for IRQ
	-. roonbridge toram & tweak binaries
	-. Turn off SPDIF-Transceiver (card 0)
