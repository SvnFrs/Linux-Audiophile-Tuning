1. tmpfs for libasound, mpd and upmpdcli

1.1 Raspbian Audio Renderer

$ mount | grep tmpfs; ls -al /usr/lib/arm-linux-gnueabihf/libasound*
$ cd /usr/lib/arm-linux-gnueabihf
$ #cd /usr/lib/arm-linux-gnueabi
$ #cd /usr/lib/x86_64-linux-gnu
$ ls -al libasound.so*
$ [ -e libasound.so.2 ] && [ ! -e libasound.so.2.sav ] && sudo mv libasound.so.2 libasound.so.2.sav
$ [ -e libasound.so.2.0.0 ] && [ ! -e libasound.so.2.0.0.sav ] && sudo mv libasound.so.2.0.0 libasound.so.2.0.0.sav
$ sudo ln -sf /dev/shm/libasound.so.2.0.0 /usr/lib/arm-linux-gnueabihf/libasound.so.2
[ -e /usr/bin/mpd.sav ] && [ ! -e /usr/bin/mpd ] && sudo mv /usr/bin/mpd.sav /usr/bin/mpd
[ -e /etc/mpd.conf.sav ] && [ ! -e /etc/mpd.conf ] && sudo mv /etc/mpd.conf.sav /etc/mpd.conf
[ -e /usr/bin/upmpdcli.sav ] && [ ! -e /usr/bin/upmpdcli ] && sudo mv /usr/bin/upmpdcli.sav /usr/bin/upmpdcli
[ -e /etc/upmpdcli.conf.sav ] && [ ! -e /etc/upmpdcli.conf ] && sudo mv /etc/upmpdcli.conf.sav /etc/upmpdcli.conf
$ sudo nano /etc/rc.local
	taskset -ac $s_task /dev/shm/upmpdcli -c /dev/shm/upmpdcli.conf
	/dev/shm/mpd /dev/shm/mpd.conf

sudo nano /etc/rc.local

[ ! -e /usr/lib/arm-linux-gnueabihf/libasound.so.2 ] && [ -e /usr/lib/arm-linux-gnueabihf/libasound.so.2.sav ] && mv /usr/lib/arm-linux-gnueabihf/libasound.so.2.sav /usr/lib/arm-linux-gnueabihf/libasound.so.2

=>

cp /usr/lib/arm-linux-gnueabihf/libasound.so.2.0.0.sav /dev/shm/libasound.so.2.0.0
cp /usr/bin/mpd /etc/mpd.conf /usr/bin/upmpdcli /etc/upmpdcli.conf /dev/shm/

 [ -e /usr/lib/arm-linux-gnueabihf/libasound.so.2 ] && mv /usr/lib/arm-linux-gnueabihf/libasound.so.2 /usr/lib/arm-linux-gnueabihf/libasound.so.2.sav

=> Remove!

1.2 Pogoplug Audio Renderer

# mount | grep tmpfs

# [ -e /usr/lib/arm-linux-gnueabi/libasound.so.2 ] && [ ! -e /usr/lib/arm-linux-gnueabi/libasound.so.2.sav ] && sudo mv /usr/lib/arm-linux-gnueabi/libasound.so.2 /usr/lib/arm-linux-gnueabi/libasound.so.2.sav
# [ -e /usr/lib/arm-linux-gnueabi/libasound.so.2.0.0 ] && [ ! -e /usr/lib/arm-linux-gnueabi/libasound.so.2.0.0.sav ] && sudo mv /usr/lib/arm-linux-gnueabi/libasound.so.2.0.0 /usr/lib/arm-linux-gnueabi/libasound.so.2.0.0.sav
# sudo ln -sf /dev/shm/libasound.so.2.0.0 /usr/lib/arm-linux-gnueabi/libasound.so.2
# sed -i 's/\[ ! -e \/usr\/lib\/arm-linux-gnueabi\/libasound.so.2 \].*/cp \/usr\/lib\/arm-linux-gnueabi\/libasound.so.2.0.0.sav \/dev\/shm\/libasound.so.2.0.0\ncp \/usr\/bin\/mpd \/etc\/mpd.conf \/usr\/bin\/upmpdcli \/etc\/upmpdcli.conf \/dev\/shm\//' /etc/rc.local
# sed -i '/ \[ -e \/usr\/lib\/arm-linux-gnueabi\/libasound.so.2 \].*/,+1d' /etc/rc.local
# sed -i 's/\/usr\/local\/bin\/upmpdcli /\/dev\/shm\/upmpdcli /; s/\/usr\/local\/etc\/upmpdcli.conf/\/dev\/shm\/upmpdcli.conf/; s/\/usr\/bin\/mpd /\/dev\/shm\/mpd /; s/\/etc\/mpd.conf/\/dev\/shm\/mpd.conf/' /etc/rc.local

2. sudo nano /usr/share/alsa/alsa.conf
	ctl.shm={type=null}

3. sudo nano /etc/mpd.conf
	mixer_type		"none"		# outside ALSA
	mixer_type		"none"		#  inside ALSA
	mixer_device		"ctl.shm"
	buffer_time		"392568"
	audio_buffer_size	"3085"
	buffer_before_play	"10.957627697565705837856563346167531656242698017831100272411200196065140099708349450024423432855536558154382230793343444537784439453489997744748984788891111407326040912695019094940056200335523522363317439609406420665787760565949985597819576822776962605334508403%"

	sudo sed -i 's/%/'"$(printf '0%.s' $(seq 1 $((4409-258))))"'%/' /etc/mpd.conf

4. sudo nano /etc/sysctl.conf

	sysctl -w kernel.sched_rt_period_us=1000001
	sysctl -w kernel.sched_min_granularity_ns=230000
	sysctl -w kernel.sched_wakeup_granularity_ns=388348
	sysctl -w kernel.sched_shares_window_ns=346000

5. sudo nano /etc/rc.local
	nohup ... >/dev/null 2>&1 &
	/dev/shm/mpd /dev/shm/mpd.conf >/dev/null 2>&1