PC Audio Render from Voyage Linux

0. USB Install

	$ wget http://mirror.voyage.hk/download/voyage/voyage-current.tar.xz
	$ sudo su
	# tar --numeric-owner -Jxf voyage-current.tar.xz
	# cd voyage-current
	# mkdir /mnt/cf
	# fdisk -l
	# gparted or ./usr/local/sbin/format-cf.sh /dev/sdb # format USB drive with ext2
	# ./usr/local/sbin/voyage.update
	# cat .voyage-install.conf
		#
		# This file generated automatically by voyage-install.sh
		# on Fri Oct 14 01:01:09 KST 2016
		#

		DISTDIR=/home/parkmino/Downloads/pc_audio_renderer/voyage-current
		TARGET_DISK=/dev/sdb
		TARGET_PART=1
		TARGET_MOUNT=/mnt/cf
		BOOTSTRAP_PART=1
		SYSTEM_BOOTSTRAP=grub
		MAKEFS=2
		VOYAGE_PROFILE="Generic PC"
		VOYAGE_SYSTEM_CONSOLE=standard
	# sync
	# exit
	$ ssh root@usb_pc_ip
	  root@usb_pc_ip's password: voyage
	$ scp mpd.conf icon.png kr2mpd ut2mpd Internet_Radios.m3u *.pls root@192.168.0.x:/root/

1. System update & install MPD clients

	apt-get update
	apt-get upgrade
	apt-get dist-upgrade
	apt-get install nano wget ca-certificates sysv-rc-conf
	apt-get install mpc ncmpc

2. Kernel option

	nano /boot/grub/menu.lst
		timeout 0
		kernel /vmlinuz ... noapic apm=off consoleblank=0 elevator=noop selinux=0

3. Localisation

	#apt-get install locales
	#dpkg-reconfigure locales
	 dpkg-reconfigure tzdata

4. Disable modules

	lsmod
	nano /etc/modprobe.d/voyage.conf
		blacklist ...

5. ALSA configuration
	
6. MPD Settings

	Compile MPD
	sysv-rc-conf
		Disable mpd service

7. Upmpdcli

	nano /etc/apt/sources.list.d/upmpdcli.list
		deb http://www.lesbonscomptes.com/upmpdcli/downloads/debian-jessie/ unstable main
		deb-src http://www.lesbonscomptes.com/upmpdcli/downloads/debian-jessie/ unstable main
	apt-get update
	apt-get install upmpdcli

	wget http://www.lesbonscomptes.com/upmpdcli/downloads/debian-jessie/pool/main/libu/libupnpp4/libupnpp4_0.16.0-1~ppa1~unstable_i386.deb
	wget http://www.lesbonscomptes.com/upmpdcli/downloads/debian-jessie/pool/main/u/upmpdcli/upmpdcli_1.2.15-2~ppa1~unstable_i386.deb
	dpkg -i *.deb

8. CIFS & NFS mounting

	apt-get install cifs-utils nfs-common
	mkdir /mnt/cifs /mnt/nfs
	ln -s /mnt/     /var/lib/mpd/music
	nano /etc/fstab
		#//192.168.0.x/xxx /mnt/cifs cifs guest,ro,rsize=8192,iocharset=utf8 0 0
		#192.168.0.x:/xxx  /mnt/nfs  nfs  ro,sync,hard,intr,rsize=8192,iocharset=utf8 0 0
		
9. Remove swap (Not applicable)

	nano /etc/fstab
		#...swap...

10. Edit /etc/rc.local

	nano /etc/rc.local
	
11. Sysctl Configuration

	nano /etc/sysctl.conf

12. Disable TTYs

	#for Upstart
	nano /etc/inittab
		#... tty1-6

13. Disable services

	sysv-rc-conf
		Remove alsa-utils
	systemctl disable alsa-utils
	nano /etc/rc.local
		for i in watchdog rpcbind dnsmasq cron nfs-common wd_keepalive # dbus ssh
		do
		 service $i stop
		done

14. USB Mount

	nano /lib/udev/rules.d/11-my-media-automount.rules

15. Internet Radio

	ln -s /root/kr2mpd /root/ut2mpd /usr/bin/
	mv Internet_Radios.m3u /var/lib/mpd/playlists/
	mkdir /var/lib/mpd/music/webradio
	cp *.pls /var/lib/mpd/music/webradio/

16. Make voyage linux rw

	# nano /etc/init.d/voyage-util
		#echo -n "Remounting / as read-only ... "
		#/usr/local/sbin/remountro
		#echo "Done."
	# nano /etc/rc.local
		remountro
		exit 0

17. Make Image

	echo "* Mino's UPnP Audio Renderer for Alix 18.04" > ~/release
	mpc clear
	rm -f /root/.bash_history ~/.bash_history ; history -c
	poweroff

	$ sudo fdisk -l
	$ sudo dd bs=4M if=/dev/sdb of=alix_audio_renderer_18.04.img
	$ zip alix_audio_renderer_18.04.zip alix_audio_renderer_18.04.img
