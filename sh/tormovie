#!/bin/sh

[ -n "$1" ] && torrent="$1" || torrent=qq # boja wal qq

if [ $torrent = boja ]; then
 url="https://torrentboza.net"
 printf "\n%s\n\n" "$url"
 ! wget --spider -q "$url" 2>&1 && echo "Not connected and exit!" && exit
 url="$url/bbs/board.php?bo_table=movie"
 for i in $(seq 1 10); do
 #curl -s "$url" | grep '<strong>' | head -15 | cut -d'>' -f2 | cut -d'<' -f1 | nl
  printf "%2d.%s\n" $i "$(curl -s "$url" | grep -A 60 best-post-addon | grep -o '\[.*' | head -$i | tail -1 | cut -d'<' -f1 | sed 's/$[ \t]*//; s/&lt;/</; s/&gt;/>/')"
  printf "     $(curl -s "$url" | grep -A 60 best-post-addon | grep -m$i "href" | tail -1 | cut -d\" -f2 | sed 's/amp;//')\n"
 done
elif [ $torrent = wal ]; then
 url="https://torrentwal.com"
 printf "\n%s\n\n" $url
 ! wget --spider -q --no-check-certificate "$url" 2>&1 && echo "Not connected and exit!" && exit
 for i in $(seq 1 10); do
  name=$(curl -s -k "$url" | grep -o '영화</a> 인기자료.*' | sed 's/>[0-9]*\. <a href='\''\.\./\n/g' | head -$((i+1)) | tail -1 | cut -d'>' -f2 | cut -d'<' -f1 | sed 's/^[ \t]*//')
  [ -z "$name" ] && echo "Not found and exit!" && exit
  printf "%2d.%s\n" $i "$name"
 #printf "%2d.%s\n" $i "$(curl -s -k "$url" | grep -o '영화</a> 인기자료.*' | sed 's/>[0-9]*\. <a href='\''\.\./\n/g' | head -$((i+1)) | tail -1 | cut -d'>' -f2 | cut -d'<' -f1 | sed 's/^[ \t]*//')"
  printf "     $url$(curl -s -k "$url" | grep -o '영화</a> 인기자료.*' | sed 's/>[0-9]*\. *<a href='\''\.\./\n/g' | head -$((i+1)) | tail -1 | cut -d\' -f1)\n"
 done
elif [ $torrent = qq ]; then
 url="https://토렌트큐큐.com"
#url="https://torrentqq30.com"
 printf "\n%s\n\n" $url
 ! wget --spider -q "$url" 2>&1 && echo "Not connected and exit!" && exit
 url="$(curl -s "$url" | grep -o href=.* | cut -d\" -f2)torrent/popular.html?period=d&board=mov"
#url="$url/torrent/popular.html?period=d&board=mov"
 for i in $(seq 1 10); do
  name=$(curl -s "$url" | sed 's/title=/\n/g' | head -$((i+1)) | tail -1 | cut -d\" -f2)
  [ -z "$name" ] && echo "Not found and exit!" && exit
  printf "%2d.%s\n" $i "$name"
 #printf "%2d.%s\n" $i "$(curl -s "$url" | sed 's/title=/\n/g' | head -$((i+1)) | tail -1 | cut -d\" -f2)"
 #printf "     $(curl -s "$url" | sed 's/<\/span><a href=/\n/g' | head -$((i+1)) | tail -1 | cut -d\" -f2)\n"
  printf "     $(curl -s "$url" | grep -o "http[s]://torrentqq[0-9]*.com/torrent/mov/[0-9]*.html" | head -$i | tail -1 | cut -d\" -f2)\n"
 done
else
 echo "$1 is not supported"
fi
