#!/bin/sh

#prog_1="JTBC 뉴스룸"
 prog_1="보이스 코리아 2020\t(금 19:00-21:00)"
 prog_2="맛있는 녀석들\t(금 20:00-21:20)"
 prog_3="팬텀싱어3\t\t(금 21:00-23:00)"
 prog_4="비긴어게인 코리아\t(토 23:00-01:00)"
 prog_5="악인전\t\t(토 22:55-00:15)"
 prog_6="멜론"

nr=1

while true; do
 prog=$(eval echo \"\$prog_$nr\")
 [ -z "$prog" ] && break
 printf "(%d) %s\n" $nr "$prog"
 nr=$(($nr+1))
done

read -p " " i

case $i in
#1) [ $(date +%k) -ge 22 ] && time="today 21:30" || time="yesterday 21:30" ;;
 1) [ $(date +%u) -eq 5 ] && [ $(date +%k) -ge 22 ] && time="today 21:00" || time="last friday 21:00" ;;
 2) [ $(date +%u) -eq 5 ] && [ $(date +%k) -ge 22 ] && time="today 21:20" || time="last friday 21:20" ;;
 3) time="last friday 23:00"	;;
 4) time="last saturday 23:59"	;;
 5) time="last saturday 23:59"	;;
 6) time="yesterday"		;;
 *) exit			;;
esac

prog=$(eval echo \"\$prog_$i\" | cut -f1)

if [ "$time" = yesterday ]; then
 hour=24
 find="$prog 토렌트"
else
 hour=$((($(date +%s)-$(date +%s -d "$time"))/3600))
 [ $hour -le 0 ] && hour=1
 find="$prog $(date +%y%m%d -d "$time") 토렌트"
fi

cmd="googler --colorize -t h$hour -n 9 --np "$find""
echo ; echo " $cmd"
$cmd | more
