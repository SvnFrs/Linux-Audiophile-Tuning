http://developer.artik.io/documentation/artik/getting-started/
http://developer.artik.io/downloads/artik710-sdfuse-a710-os-18-10-00-img/download   # Artik 710
http://developer.artik.io/downloads/artik710s-sdfuse-a710s-os-18-10-00-img/download # Artik 710s
http://developer.artik.io/documentation/developer-guide/update-image/updating-artik-image.html

1. QEMU

$ sudo apt install qemu-user-static
$ mkdir /home/parkmino/Downloads/artik710/rootfs
$ sudo tar xf /home/parkmino/Downloads/artik710/img/rootfs.tar.gz -C /home/parkmino/Downloads/artik710/rootfs
$ sudo cp /usr/bin/qemu-aarch64-static /home/parkmino/Downloads/artik710/rootfs/usr/bin

$ sudo mount -ro bind /dev /home/parkmino/Downloads/artik710/rootfs/dev/
$ sudo mount -ro bind /proc /home/parkmino/Downloads/artik710/rootfs/proc/
$ sudo chmod 777 /home/parkmino/Downloads/artik710/rootfs/tmp

$ sudo mount -o bind /dev /home/parkmino/Downloads/artik710/rootfs/dev/
$ sudo mount -o bind /proc /home/parkmino/Downloads/artik710/rootfs/proc/
$ sudo chmod 777 /home/parkmino/Downloads/artik710/rootfs/tmp

$ sudo cp /etc/resolv.conf /home/parkmino/Downloads/artik710/rootfs/etc/.

$ sudo chroot /home/parkmino/Downloads/artik710/rootfs

### Build mpd, libasound, libaudiofile, libflac. mympd, librespot

# exit

$ sudo umount -A /home/parkmino/Downloads/artik710/rootfs/dev
$ sudo umount -A /home/parkmino/Downloads/artik710/rootfs/proc
$ sudo rm /home/parkmino/Downloads/artik710/rootfs/etc/resolv.conf

2. Image

$ sudo fdisk -l
$ sudo umount /dev/sdc?
$ sudo dd status=progress bs=4M if=/home/parkmino/Downloads/artik710/artik710_sdfuse-0710GC0F-44U-DJW0-20181030.003001.img of=/dev/sdc
$ sync

### SW402-4 ON  for the ARTIK 530/710 board
### Boot from Micro SD Card
### SW402-4 OFF for the ARTIK 530/710 board

3. Login

$ ssh root@192.168.0.x
	password : root

4. Update

# uname -a; cat /etc/os-release
	Ubuntu 16.04.5 LTS (Linux artix 4.4.159)
# apt-get update
# apt-get install bc file nano psmisc software-properties-common unzip # ffmpeg libav-tools
# nano /etc/apt/sources.list
	...
	deb http://ports.ubuntu.com/ubuntu-ports/ xenial-backports main universe
	deb-src http://ports.ubuntu.com/ubuntu-ports/ xenial-backports main universe
# mv /etc/apt/sources.list.d/artik-e2e-sources.list /etc/apt/sources.list.d/artik-e2e-sources.list.orig
# mv /etc/apt/sources.list.d/artik-platform-artik710-sources.list /etc/apt/sources.list.d/artik-platform-artik710-sources.list.orig
# apt-get update
	http://repo.artik.cloud/artik/bin/pub/artik-platform/ubuntu/artik710 (X)
# apt-get -t xenial-backports upgrade
# apt-get dist-upgrade
# apt-get autoremove
# rm /etc/resolv.conf
# nano -L /etc/resolv.conf
	nameserver 1.1.1.1    
	  
# dpkg-reconfigure locales
# locale
# locale -a
# locale -a -v
# ls -al /var/lib/locales/supported.d/
# nano /var/lib/locales/supported.d/en
	en_US UTF-8
# rm -rfv /usr/lib/locale/*
# locale-gen
# locale -a -v

# dpkg-reconfigure tzdata
## apt-get install update-manager-core
## do-release-upgrade
# reboot
# uname -a; cat /etc/os-release
	Ubuntu 16.04.6 LTS

### Wired
## connmanctl services
## connmanctl config $eth --ipv4 manual 192.168.0.x 255.255.255.0 192.168.0.1
## connmanctl config $eth --ipv4 dhcp
### Wireless
## wpa_cli -iwlan0 scan && wpa_cli scan_results
## wpa_passphrase MyAP abcd1234 >> /etc/wpa_supplicant/wpa_supplicant.conf
## systemctl restart wpa_supplicant
## dhclient wlan0

## nano /etc/wpa_supplicant/wpa_supplicant.conf
	#psk
	key_mgmt=NONE
	auth_alg=OPEN

# echo '[Unit]
Description=Run dhcp service for wifi interface
After=wpa_supplicant.service
Requires=wpa_supplicant.service
[Service]
ExecStart=/sbin/dhclient wlan0
StandardOutput=syslog
StandardError=syslog
[Install]
WantedBy=multi-user.target' > /etc/systemd/system/wlan_dhcp.service
## systemctl enable wlan_dhcp
## systemctl start  wlan_dhcp

### Hostname & Domain name
# hostname -f
# nano /etc/hostname
# nano /etc/hosts
# hostname $(cat /etc/hostname)
## /etc/resolvconf/resolv.conf.d/head
	domain your.domain.name
## resolvconf -u
# hostnamectl
# nano -L /etc/avahi/avahi-daemon.conf
	host-name=bann
	domain-name=local
# systemctl restart avahi-daemon

### SSH message
# ls /etc/update-motd.d/*

### Remove modules
# lsmod
# nano /etc/modprobe.d/artik710.conf
	blacklist ...

### Remove services
# systemctl list-unit-files | grep enabled
# apt-get remove zigbeed
# apt-get autoremove
# systemctl stop    ble-onboarding-launcher bluetooth dnsmasq mosquitto pulseaudio wpa_supplicant getty@tty1 systemd-resolved # serial-getty@ttySAC3 avahi-daemon
# systemctl disable ble-onboarding-launcher bluetooth dnsmasq mosquitto pulseaudio wpa_supplicant getty@tty1 systemd-resolved # serial-getty@ttySAC3 avahi-daemon
# rm   /etc/resolv.conf
# nano /etc/resolv.conf
	nameserver 8.8.8.8
# systemctl mask systemd-journald.service systemd-journald.socket systemd-journald-audit.service systemd-journald-audit.socket systemd-journald-dev-log.socket systemd-journal-flush
# systemctl mask systemd-logind wpa_supplicant
# pkill hciattach; pkill tzdaemon

### Kernel option - N.A.

### ALSA
# sed -i 's/pcm.0.card 0/pcm.0.card 1/' /usr/share/alsa/alsa.conf.{min,mix,plug}

### MPD binary & mpd.conf
## apt-get install mpd mpc ncmpc
## systemctl restart mpd
## systemctl disable mpd
# apt-get install libcue1 libaudiofile1 libavformat-ffmpeg56 libflac8 libid3tag0 libmpdclient2 libupnp6 mpc ncmpc
# mkdir -p /var/lib/mpd/music /var/lib/mpd/playlists /run/mpd
# cp mpd /usr/bin/
# cp mpd.conf /etc/mpd.conf.sav

### Upmpdcli
## add-apt-repository ppa:jean-francois-dockes/upnpp1
## apt-get update
## apt-get install upmpdcli
# wget https://launchpad.net/~jean-francois-dockes/+archive/ubuntu/upnpp1/+files/libupnpp5_0.17.2-1~ppa1~xenial1_arm64.deb
# wget https://launchpad.net/~jean-francois-dockes/+archive/ubuntu/upnpp1/+files/upmpdcli_1.4.5-1~ppa1~xenial1_arm64.deb
##wget https://launchpad.net/~jean-francois-dockes/+archive/ubuntu/upnpp1/+files/upmpdcli-qobuz_1.4.5-1~ppa1~xenial1_all.deb
# wget https://launchpad.net/~jean-francois-dockes/+archive/ubuntu/upnpp1/+files/upmpdcli-tidal_1.4.5-1~ppa1~xenial1_all.deb
# apt-get install libupnp6 libmpdclient2 libexpat1 libcurl3 libmicrohttpd10 libjsoncpp1 python3 python3-requests
# dpkg -i libupnpp*.deb upmpdcli_*.deb
# nano -L /etc/upmpdcli.conf
	friendlyname = Bann Audio Sylphid Network Player
	checkcontentformat = 0
	tidalquality = lossless
	[radio ...]
	...
## wget -O icon.png https://github.com/openwrt/packages/raw/master/sound/upmpdcli/files/upmpdcli.png
# mv ./icon.png /usr/share/upmpdcli/icon.png
# systemctl restart upmpdcli
# systemctl disable upmpdcli

### uhubctl
## apt-get install libusb-1.0-0
# mv uhubctl /usr/bin/
# nano /etc/rc.local
	uhubctl -a 0 -p 1,3

### audio.conf
# nano /etc/default/audio.conf

	# audio.conf
	#
	# alsa has the options of min(imal), mix(er) and orig(inal).
	# To enable a feature, set feature=on.
	# To disable a feature, set feature=off
	# To ignore a feature, comment out the line by '#'

	alsa=min
	upnp=on
	airplay=off
	roon=on
	roontoram=off
	spotify=off
	tidal=off
	dbus=on
	wifi=off
	mympd=on
	ssh=off
	serial=on

### /etc/fstab
# nano /etc/fstab

	##/dev/sda1         /mnt/usb  vfat    ro 0 0
	##/dev/sda1         /mnt/usb  ntfs-3g ro 0 0
	#//192.168.0.x/Music /mnt/cifs cifs    guest,ro,iocharset=utf8 0 0
	#//192.168.0.x/Music /mnt/cifs cifs    username=user,password=pass,ro,iocharset=utf8 0 0

### myMPD

# apt-get install gcc cmake perl libssl-dev libid3tag0-dev libflac-dev
# curl -s https://github.com/jcorporation/myMPD/releases/latest | cut -d\" -f2 | sed 's/releases\/tag/archive/; s/$/.tar.gz/' | wget --no-check-certificate "$(cat -)" -O ./mympd.tar.gz
# tar xvzf mympd.tar.gz -d ~/ && rm mympd.tar.gz
# cd myMPD*
# ENABLE_SSL="OFF" ./build.sh releaseinstall

# apt-get install build-essential fakeroot
# apt-get install -t trusty-backports debhelper
# sed -i '120,122p' CMakeLists.txt
# ./build.sh pkgdebian
# ls -al package/mympd*.deb

# apt-get install libc6 libid3tag0 libflac8 lrzsz openssl # libmediainfo0v5

# dpkg -i ./mympd*.deb
# ls -al /usr/bin/mympd
# file /usr/bin/mympd
# strip --strip-debug /usr/bin/mympd
# ls -al /usr/bin/mympd

##cp mympd /usr/bin/
##cp mympd.conf /etc/
##cp mympd.service /lib/systemd/system/
##mkdir /var/lib/mympd
##getent group  mympd > /dev/null || groupadd -r mympd
##getent passwd mympd > /dev/null || useradd -r -g mympd -s /bin/false -d /var/lib/mympd mympd

# systemctl stop    mympd
# systemctl disable mympd
# nano /usr/lib/systemd/system/mympd.service
	#Requires=network.target local-fs.target mpd.service
	#After=mpd.service
# systemctl daemon-reload

# nano /etc/mympd.conf
	 host = 127.0.0.1
	 port = 6600
	 music_directory = /var/lib/mpd/music/
	#ssl = false
	#sslport = 443
	 loglevel = 1
	 user = mympd
	 syscmds = true

# sed -i '/\[syscmds\]/q' /etc/mympd.conf

# sh -c "echo 'HR =' >> /etc/mympd.conf"
# sh -c "echo 'KBS 클래식 FM = kr2mpd 1fm' >> /etc/mympd.conf"
# sh -c "echo 'KBS 쿨 FM     = kr2mpd 2fm' >> /etc/mympd.conf"
# sh -c "echo 'MBC FM        = kr2mpd mbcm' >> /etc/mympd.conf"
# sh -c "echo 'MBC FM4U      = kr2mpd mbc4u' >> /etc/mympd.conf"
# sh -c "echo 'SBS 파워 FM   = kr2mpd sbsp' >> /etc/mympd.conf"
# sh -c "echo 'SBS 러브 FM   = kr2mpd sbsl' >> /etc/mympd.conf"
# sh -c "echo 'HR =' >> /etc/mympd.conf"
# sh -c "echo '웹 설정 - Web Settings   = ttyd -o -O -p 8080 bash audio-config&>/dev/null</dev/null 2>/dev/null' >> /etc/mympd.conf"
# sh -c "echo '웹 터미널 - Web Terminal = ttyd -o -O -p 8080 bash -c \"cd /root; sudo su\"&>/dev/null</dev/null 2>/dev/null' >> /etc/mympd.conf"
# sh -c "echo 'HR =' >> /etc/mympd.conf"
# sh -c "echo '다시 시작 - Reboot    = sudo reboot' >>   /etc/mympd.conf"
# sh -c "echo '전원 끄기 - Power off = sudo poweroff    ' >> /etc/mympd.conf"
# sh -c "printf '  ' >> /etc/mympd.conf"
	
# sh -c "printf 'HR =
KBS 클래식 FM = kr2mpd 1fm
KBS 쿨 FM     = kr2mpd 2fm
MBC FM        = kr2mpd mbcm
MBC FM4U      = kr2mpd mbc4u
SBS 파워 FM   = kr2mpd sbsp
SBS 러브 FM   = kr2mpd sbsl
HR =
웹 설정 - Web Settings   = ttyd -o -O -p 8080 bash audio-config&>/dev/null</dev/null 2>/dev/null
웹 터미널 - Web Terminal = ttyd -o -O -p 8080 bash -c "cd /root; sudo su"&>/dev/null</dev/null 2>/dev/null
HR =
다시 시작 - Reboot    = sudo reboot
전원 끄기 - Power off = sudo poweroff    \n  ' >> /etc/mympd.conf"

# echo 'mympd ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers
# cp /lib/systemd/system/mympd.service /etc/systemd/system/mympd.service
# nano /etc/systemd/system/mympd.service
	#Requires=network.target local-fs.target mpd.service
	#After=mpd.service
	#Protect
	#Restrict
# systemctl disable mympd
# systemctl daemon-reload
# systemctl status mympd

### ttyd
# curl -s https://github.com/tsl0922/ttyd/releases/latest | cut -d\" -f2 | sed 's/tag/download/; s/$/\/ttyd_linux.aarch64/' | wget "$(cat -)" -P ~/
# chmod +x ~/ttyd_linux.aarch64
# mv ~/ttyd_linux.aarch64 /usr/bin/ttyd

### rc.local
# mv /usr/lib/aarch64-linux-gnu/libaudiofile.so.1.0.0 /usr/lib/aarch64-linux-gnu/libaudiofile.so.1.0.0.sav
# mv /usr/lib/aarch64-linux-gnu/libFLAC.so.8.3.0 /usr/lib/aarch64-linux-gnu/libFLAC.so.8.3.0.sav
### sysctl.conf
### USB mount - N.A.
### Internet radio (kr2mpd, sbs_dec.py, ut2mpd, tts2mpd)
# apt-get update
# apt-get install python-crypto
# curl -L https://yt-dl.org/downloads/latest/youtube-dl -o /usr/local/bin/youtube-dl
# chmod a+rx /usr/local/bin/youtube-dl
# nano /var/lib/mpd/playlists/internet\ radio.m3u
# mkdir /var/lib/mpd/music/webradio
# mv *.pls /var/lib/mpd/music/webradio
# mpc update

### audio-config
### Roon Bridge
### Spotifyd
### AirUPnP

### Shairport-sync (Airplay)
## add-apt-repository ppa:dantheperson/shairplay-sync
## apt-get update
## apt-get install shairport-sync

### HQPlayer NAA
## wget --no-check-certificate https://www.signalyst.eu/bins/naa/linux/xenial/networkaudiod_3.5.5-39_arm64.deb
## dpkg -i networkaudiod*.deb
## sed -i '/alsa=/s/=.*/=mix/' /etc/default/audio.conf

### Squeezelite
## apt-get install squeezelite
## sed -i '/SL_SOUNDCARD/s/^#*//; /SL_SOUNDCARD/s/".*"/"pcm.0"/' /etc/default/squeezelite

### MicroSD mount
# apt-get install exfat-fuse exfat-utils # microSDXC
# mkdir /mnt/microSD
# nano /etc/fstab
	/dev/mmcblk1p1 /mnt/microSD auto defaults,nofail,x-systemd.automount,x-systemd.device-timeout=1,ro 0 2
# ln -sf /mnt/microSD /var/lib/mpd/music

# systemctl disable sshd
# sed -i '/^serial/s/on/off/' /etc/default/audio.conf

### Back up
https://davidgs.com/2017/how-to-save-your-artik-520-backup/
https://github.com/davidgs/ARTIK-5-backup

# apt-get update
# apt-get upgrade
# apt-get dist-upgrade
# systemctl disable sshd
# systemctl daemon-reload
# youtube-dl --update
# echo "* Audio Renderer 19.04" > ~/release
# mpc clear
# rm -rf /var/roon/* /var/lib/mympd/covercache/*
# cat /lib/systemd/system/sshd.service
# rm /etc/systemd/system/*/sshd.service
# rm -f /root/.bash_history ~/.bash_history ; history -c
# tar cf renderer.tar --no-recursion renderer

cf)
https://oinkzwurgl.org/hacking/bash_cgi/
http://www.team2053.org/docs/bashcgi/postdata.html
https://marc.waeckerlin.org/computer/blog/parsing_of_query_string_in_bash_cgi_scripts

LED
https://developer.artik.io/documentation/artik/tutorials/blink-an-led.html
– Red  LED : sysfs GPIO 28 on ARTIK 530/710 (LED400)
– Blue LED : sysfs GPIO 38 on ARTIK 530/710 (LED401)
# echo 38 > /sys/class/gpio/export
# ls ls /sys/class/gpio
# echo out > /sys/class/gpio/gpio38/direction
# echo 1 > /sys/class/gpio/gpio38/value
